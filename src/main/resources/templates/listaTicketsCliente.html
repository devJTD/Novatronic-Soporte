<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Novatronic - Mis Tickets</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="/css/nova-styles.css">
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-glass fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand d-flex align-items-center" href="/cliente/dashboard">
                <img src="/img/logo.png" alt="Novatronic">
                <span class="badge bg-info ms-2">CLIENTE</span>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item"><a class="nav-link" href="/cliente/dashboard"><i
                                class="bi bi-speedometer2"></i> Dashboard</a></li>
                    <li class="nav-item"><a class="nav-link" href="/cliente/registro-ticket"><i
                                class="bi bi-plus-circle"></i> Nuevo Ticket</a></li>
                    <li class="nav-item"><a class="nav-link active" href="/cliente/lista-tickets"><i
                                class="bi bi-list-task"></i> Mis Tickets</a></li>
                </ul>
                <div class="d-flex align-items-center">
                    <span class="text-white me-3"><i class="bi bi-building"></i> Banco Central</span>
                    <a class="btn btn-sm btn-nova btn-nova-danger" href="/login"><i class="bi bi-box-arrow-right"></i>
                        Salir</a>
                </div>
            </div>
        </div>
    </nav>

    <div class="main-content">
        <div class="flex justify-between items-center mb-6">
            <div>
                <h1 class="text-4xl font-bold text-white mb-2"><i class="bi bi-list-check"></i> Mis Tickets de Soporte
                </h1>
                <p class="text-glass-muted">Gestione y consulte el estado de todos sus tickets</p>
            </div>
            <a href="/cliente/registro-ticket" class="btn btn-nova btn-nova-primary btn-lg">
                <i class="bi bi-plus-circle"></i> Crear Ticket Nuevo
            </a>
        </div>

        <!-- Req 13: Consulta de Estado en Vivo - Estadísticas Rápidas -->
        <div class="row g-4 mb-6">
            <div class="col-lg-3 col-md-6">
                <div class="card-glass">
                    <div class="card-glass-body">
                        <div class="flex items-center gap-4">
                            <div class="p-4 rounded-full" style="background: var(--gradient-info);">
                                <i class="bi bi-ticket-detailed-fill text-4xl text-white"></i>
                            </div>
                            <div>
                                <div class="text-sm text-glass-muted">Total Tickets</div>
                                <div class="text-3xl font-bold text-white">28</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="card-glass">
                    <div class="card-glass-body">
                        <div class="flex items-center gap-4">
                            <div class="p-4 rounded-full" style="background: var(--gradient-primary);">
                                <i class="bi bi-hourglass-split text-4xl text-white"></i>
                            </div>
                            <div>
                                <div class="text-sm text-glass-muted">En Proceso</div>
                                <div class="text-3xl font-bold text-white">5</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="card-glass">
                    <div class="card-glass-body">
                        <div class="flex items-center gap-4">
                            <div class="p-4 rounded-full" style="background: var(--gradient-warning);">
                                <i class="bi bi-chat-left-dots-fill text-4xl text-white"></i>
                            </div>
                            <div>
                                <div class="text-sm text-glass-muted">Pendientes Respuesta</div>
                                <div class="text-3xl font-bold text-white">1</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="card-glass">
                    <div class="card-glass-body">
                        <div class="flex items-center gap-4">
                            <div class="p-4 rounded-full" style="background: var(--gradient-success);">
                                <i class="bi bi-check-circle-fill text-4xl text-white"></i>
                            </div>
                            <div>
                                <div class="text-sm text-glass-muted">Resueltos</div>
                                <div class="text-3xl font-bold text-white">22</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Filtros Avanzados -->
        <div class="card-glass mb-6">
            <div class="card-glass-body">
                <div class="row g-3">
                    <div class="col-md-3">
                        <label class="form-label-glass">Buscar por ID o Asunto</label>
                        <input type="text" class="form-glass w-full" id="searchInput"
                            placeholder="NOV-XXXX o palabra clave...">
                    </div>
                    <div class="col-md-2">
                        <label class="form-label-glass">Estado</label>
                        <select class="form-glass w-full" id="filterEstado">
                            <option value="">Todos</option>
                            <option value="nuevo">Nuevo</option>
                            <option value="clasificado">Clasificado</option>
                            <option value="proceso">En Proceso</option>
                            <option value="pendiente">Pendiente Cliente</option>
                            <option value="resuelto">Resuelto</option>
                            <option value="cerrado">Cerrado</option>
                        </select>
                    </div>
                    <div class="col-md-2">
                        <label class="form-label-glass">Prioridad</label>
                        <select class="form-glass w-full" id="filterPrioridad">
                            <option value="">Todas</option>
                            <option value="critica">Crítica</option>
                            <option value="alta">Alta</option>
                            <option value="media">Media</option>
                            <option value="baja">Baja</option>
                        </select>
                    </div>
                    <div class="col-md-2">
                        <label class="form-label-glass">Período</label>
                        <select class="form-glass w-full" id="filterPeriodo">
                            <option value="all">Todo el tiempo</option>
                            <option value="week">Última semana</option>
                            <option value="month" selected>Último mes</option>
                            <option value="quarter">Último trimestre</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <label class="form-label-glass">&nbsp;</label>
                        <div class="flex gap-2">
                            <button class="btn btn-nova btn-nova-primary flex-1" onclick="applyFilters()">
                                <i class="bi bi-funnel"></i> Filtrar
                            </button>
                            <button class="btn btn-nova" style="background: rgba(255,255,255,0.1); color: white;"
                                onclick="clearFilters()">
                                <i class="bi bi-x-circle"></i> Limpiar
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tabla de Tickets -->
        <div class="card-glass">
            <div class="card-glass-header">
                <div class="flex justify-between items-center">
                    <h3 class="text-xl font-bold mb-0"><i class="bi bi-table"></i> Listado de Tickets</h3>
                    <div class="text-sm text-glass-muted">Mostrando <strong id="showingCount">8</strong> de
                        <strong>28</strong> tickets
                    </div>
                </div>
            </div>
            <div class="table-responsive">
                </thead>
                <tbody>
                    <!-- Ticket Pendiente de Cliente (Urgente) -->
                    <tr class="bg-danger bg-opacity-10" data-estado="pendiente" data-prioridad="critica">
                        <td><strong class="text-white">NOV-3401</strong></td>
                        <td>
                            <div class="font-semibold text-white">Fallo en módulo de reportes</div>
                            <div class="text-sm text-glass-muted">API Error 503</div>
            </div>
            <small class="text-xs text-glass-muted">Esperando su respuesta</small>
            </td>
            <td>
                <a href="/cliente/detalle-ticket/NOV-3401" class="btn btn-sm btn-nova btn-nova-danger">
                    <i class="bi bi-reply-fill"></i> RESPONDER
                </a>
            </td>
            </tr>

            <!-- Tickets En Proceso -->
            <tr data-estado="proceso" data-prioridad="alta">
                <td><strong class="text-white">NOV-3398</strong></td>
                <td>
                    <div class="font-semibold text-white">Consulta sobre API v3</div>
                    <div class="text-sm text-glass-muted">Integración endpoints</div>
                </td>
                <td><span class="badge-modern badge-media">EN PROCESO</span></td>
                <td><span class="badge-modern badge-alta">ALTA</span></td>
                <td>14/11/2025<br><small class="text-glass-muted">16:00 PM</small></td>
                <td>Ayer</td>
                <td>
                    <div class="text-success font-bold">
                        <i class="bi bi-clock"></i> 2h 15m
                    </div>
                    <small class="text-xs text-glass-muted">Tiempo restante</small>
                </td>
                <td>
                    <a href="/cliente/detalle-ticket/NOV-3398" class="btn btn-sm btn-nova"
                        style="background: var(--gradient-info); color: white;">
                        <i class="bi bi-eye"></i> Ver
                    </a>
                </td>
            </tr>

            <tr data-estado="proceso" data-prioridad="media">
                <td><strong class="text-white">NOV-3390</strong></td>
                <td>
                    <div class="font-semibold text-white">Optimización de consultas BD</div>
                    <div class="text-sm text-glass-muted">Performance lenta</div>
                </td>
                <td><span class="badge-modern badge-media">EN PROCESO</span></td>
                <td><span class="badge-modern badge-media">MEDIA</span></td>
                <td>13/11/2025<br><small class="text-glass-muted">10:00 AM</small></td>
                <td>Hace 2 días</td>
                <td>
                    <div class="text-success font-bold">
                        <i class="bi bi-clock"></i> 4h 30m
                    </div>
                    <small class="text-xs text-glass-muted">SLA OK</small>
                </td>
                <td>
                    <a href="/cliente/detalle-ticket/NOV-3390" class="btn btn-sm btn-nova"
                        style="background: var(--gradient-info); color: white;">
                        <i class="bi bi-eye"></i> Ver
                    </a>
                </td>
            </tr>

            <!-- Tickets Resueltos -->
            <tr data-estado="resuelto" data-prioridad="alta">
                <td><strong class="text-white">NOV-3385</strong></td>
                <td>
                    <div class="font-semibold text-white">Error en login de usuarios</div>
                    <div class="text-sm text-glass-muted">Autenticación fallida</div>
                </td>
                <td><span class="badge-modern" style="background: var(--gradient-success);">RESUELTO</span></td>
                <td><span class="badge-modern badge-alta">ALTA</span></td>
                <td>12/11/2025<br><small class="text-glass-muted">14:30 PM</small></td>
                <td>Hace 3 días</td>
                <td>
                    <div class="text-success font-bold">
                        <i class="bi bi-check-circle"></i> 3h 20m
                    </div>
                    <small class="text-xs text-glass-muted">Resuelto en tiempo</small>
                </td>
                <td>
                    <a href="/cliente/detalle-ticket/NOV-3385" class="btn btn-sm btn-nova"
                        style="background: rgba(255,255,255,0.1); color: white;">
                        <i class="bi bi-eye"></i> Revisar
                    </a>
                </td>
            </tr>

            <i class="bi bi-check-circle-fill"></i> 6h 45m
        </div>
        <small class="text-xs text-glass-muted">Completado</small>
        </td>
        <td>
            <a href="/cliente/detalle-ticket/NOV-3380" class="btn btn-sm btn-nova"
                style="background: rgba(255,255,255,0.1); color: white;">
                <i class="bi bi-eye"></i> Ver
            </a>
        </td>
        </tr>

        <tr data-estado="resuelto" data-prioridad="baja">
            <td><strong class="text-white">NOV-3375</strong></td>
            <td>
                <div class="font-semibold text-white">Consulta sobre documentación</div>
                <div class="text-sm text-glass-muted">Manual de usuario</div>
            </td>
            <td><span class="badge-modern" style="background: var(--gradient-success);">RESUELTO</span></td>
            <td><span class="badge-modern badge-baja">BAJA</span></td>
            <td>08/11/2025<br><small class="text-glass-muted">11:00 AM</small></td>
            <td>Hace 7 días</td>
            <td>
                <div class="text-success font-bold">
                    <i class="bi bi-check-circle"></i> 18h 30m
                </div>
                <small class="text-xs text-glass-muted">Cumplido SLA</small>
            </td>
            <td>
                <a href="/cliente/detalle-ticket/NOV-3375" class="btn btn-sm btn-nova"
                    style="background: rgba(255,255,255,0.1); color: white;">
                    <i class="bi bi-eye"></i> Ver
                </a>
            </td>
        </tr>

        <tr data-estado="clasificado" data-prioridad="media">
            <td><strong class="text-white">NOV-3370</strong></td>
            <td>
                <div class="font-semibold text-white">Solicitud de nuevo reporte</div>
                <div class="text-sm text-glass-muted">Dashboard personalizado</div>
            </td>
            <td><span class="badge-modern" style="background: var(--gradient-info);">CLASIFICADO</span></td>
            <td><span class="badge-modern badge-media">MEDIA</span></td>
            <td>15/11/2025<br><small class="text-glass-muted">08:00 AM</small></td>
            <td>Hace 4 horas</td>
            <td>
                <div class="text-info font-bold">
                    <i class="bi bi-gear"></i> En revisión
                </div>
                <small class="text-xs text-glass-muted">Asignando técnico</small>
            </td>
            <td>
                <a href="/cliente/detalle-ticket/NOV-3370" class="btn btn-sm btn-nova"
                    style="background: var(--gradient-info); color: white;">
                    <i class="bi bi-eye"></i> Ver
                </a>
            </td>
        </tr>

        <tr data-estado="nuevo" data-prioridad="baja">
            <td><strong class="text-white">NOV-3365</strong></td>
            <td>
                <div class="font-semibold text-white">Pregunta sobre capacitación</div>
                <div class="text-sm text-glass-muted">Módulo administración</div>
            </td>
            <td><span class="badge-modern" style="background: var(--gradient-warning); color: white;">NUEVO</span>
            </td>
            <td><span class="badge-modern badge-baja">BAJA</span></td>
            <td>15/11/2025<br><small class="text-glass-muted">07:30 AM</small></td>
            <td>Hace 5 horas</td>
            <td>
                <div class="text-warning font-bold">
                    <i class="bi bi-hourglass"></i> Pendiente
                </div>
                <small class="text-xs text-glass-muted">En cola</small>
            </td>
            <td>
                <a href="/cliente/detalle-ticket/NOV-3365" class="btn btn-sm btn-nova"
                    style="background: var(--gradient-info); color: white;">
                    <i class="bi bi-eye"></i> Ver
                </a>
            </td>
        </tr>
        </tbody>
        </table>
    </div>

    <!-- Paginación -->
    <div class="card-glass-body border-t border-white border-opacity-10">
        <div class="flex justify-between items-center">
            <div class="text-sm text-glass-muted">
                Mostrando <strong>1-8</strong> de <strong>28</strong> tickets
            </div>
            <nav>
                <ul class="pagination mb-0">
                    <li class="page-item disabled">
                        <a class="page-link" href="#"
                            style="background: rgba(255,255,255,0.05); border-color: rgba(255,255,255,0.1); color: white;">Anterior</a>
                    </li>
                    <li class="page-item active">
                        <a class="page-link" href="#"
                            style="background: var(--gradient-primary); border: none; color: white;">1</a>
                    </li>
                    <li class="page-item">
                        <a class="page-link" href="#"
                            style="background: rgba(255,255,255,0.05); border-color: rgba(255,255,255,0.1); color: white;">2</a>
                    </li>
                    <li class="page-item">
                        <a class="page-link" href="#"
                            style="background: rgba(255,255,255,0.05); border-color: rgba(255,255,255,0.1); color: white;">3</a>
                    </li>
                    <li class="page-item">
                        <a class="page-link" href="#"
                            style="background: rgba(255,255,255,0.05); border-color: rgba(255,255,255,0.1); color: white;">4</a>
                    </li>
                    <li class="page-item">
                        <a class="page-link" href="#"
                            style="background: rgba(255,255,255,0.05); border-color: rgba(255,255,255,0.1); color: white;">Siguiente</a>
                    </li>
                </ul>
            </nav>
        </div>
    </div>
    </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Filtrado de tabla
        function applyFilters() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const estado = document.getElementById('filterEstado').value;
            const prioridad = document.getElementById('filterPrioridad').value;

            const rows = document.querySelectorAll('#ticketsTable tbody tr');
            let visibleCount = 0;

            rows.forEach(row => {
                const ticketId = row.querySelector('td:first-child').textContent.toLowerCase();
                const asunto = row.querySelector('td:nth-child(2)').textContent.toLowerCase();
                const rowEstado = row.dataset.estado;
                const rowPrioridad = row.dataset.prioridad;

                let show = true;

                if (searchTerm && !ticketId.includes(searchTerm) && !asunto.includes(searchTerm)) {
                    show = false;
                }

                if (estado && rowEstado !== estado) {
                    show = false;
                }

                if (prioridad && rowPrioridad !== prioridad) {
                    show = false;
                }

                row.style.display = show ? '' : 'none';
                if (show) visibleCount++;
            });

            document.getElementById('showingCount').textContent = visibleCount;
        }

        function clearFilters() {
            document.getElementById('searchInput').value = '';
            document.getElementById('filterEstado').value = '';
            document.getElementById('filterPrioridad').value = '';
            document.getElementById('filterPeriodo').value = 'month';
            applyFilters();
        }

        // Búsqueda en tiempo real
        document.getElementById('searchInput').addEventListener('input', applyFilters);

        // Ordenamiento de tabla
        let sortDirection = {};
        function sortTable(columnIndex) {
            const table = document.getElementById('ticketsTable');
            const tbody = table.querySelector('tbody');
            const rows = Array.from(tbody.querySelectorAll('tr')).filter(row => row.style.display !== 'none');

            sortDirection[columnIndex] = !sortDirection[columnIndex];
            const direction = sortDirection[columnIndex] ? 1 : -1;

            rows.sort((a, b) => {
                const aValue = a.cells[columnIndex].textContent.trim();
                const bValue = b.cells[columnIndex].textContent.trim();
                return aValue.localeCompare(bValue) * direction;
            });

            rows.forEach(row => tbody.appendChild(row));
        }
    </script>
</body>

</html>