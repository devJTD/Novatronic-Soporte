<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Novatronic - Detalle Ticket</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="/css/nova-styles.css">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-glass fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand d-flex align-items-center" href="/cliente/dashboard">
                <img src="/img/logo.png" alt="Novatronic">
                <span class="badge bg-info ms-2">CLIENTE</span>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item"><a class="nav-link" href="/cliente/dashboard"><i class="bi bi-speedometer2"></i> Dashboard</a></li>
                    <li class="nav-item"><a class="nav-link" href="/cliente/registro-ticket"><i class="bi bi-plus-circle"></i> Nuevo Ticket</a></li>
                    <li class="nav-item"><a class="nav-link active" href="/cliente/lista-tickets"><i class="bi bi-list-task"></i> Mis Tickets</a></li>
                </ul>
                <div class="d-flex align-items-center">
                    <span class="text-white me-3"><i class="bi bi-building"></i> Banco Central</span>
                    <a class="btn btn-sm btn-nova btn-nova-danger" href="/login"><i class="bi bi-box-arrow-right"></i> Salir</a>
                </div>
            </div>
        </div>
    </nav>

    <div class="main-content">
        <!-- Breadcrumb -->
        <nav class="mb-4">
            <ol class="breadcrumb" style="background: transparent;">
                <li class="breadcrumb-item"><a href="/cliente/dashboard" class="text-white">Dashboard</a></li>
                <li class="breadcrumb-item"><a href="/cliente/lista-tickets" class="text-white">Mis Tickets</a></li>
                <li class="breadcrumb-item active text-glass-muted">NOV-3401</li>
            </ol>
        </nav>

        <!-- Header del Ticket -->
        <div class="flex justify-between items-start mb-6">
            <div>
                <h1 class="text-4xl font-bold text-white mb-3">
                    <i class="bi bi-ticket-detailed-fill"></i> Ticket NOV-3401
                </h1>
                <h2 class="text-2xl text-glass-muted mb-3">Fallo en módulo de reportes - Error 503</h2>
                <div class="flex gap-3">
                    <span class="badge-modern badge-critica">CRÍTICA</span>
                    <span class="badge-modern" style="background: var(--gradient-warning); color: white;">PENDIENTE CLIENTE</span>
                </div>
            </div>
            <a href="/cliente/lista-tickets" class="btn btn-nova" style="background: rgba(255,255,255,0.1); color: white;">
                <i class="bi bi-arrow-left"></i> Volver
            </a>
        </div>

        <div class="row g-4">
            <!-- Columna Principal -->
            <div class="col-lg-8">
                <!-- Descripción Original -->
                <div class="card-glass mb-4">
                    <div class="card-glass-header">
                        <h3 class="text-xl font-bold mb-0"><i class="bi bi-file-earmark-text"></i> Descripción Original</h3>
                    </div>
                    <div class="card-glass-body">
                        <p class="mb-3"><strong>Reportado por:</strong> María González (Banco Central)</p>
                        <p class="mb-3">Desde la última actualización del sistema, el módulo de reportes arroja un error 503 Service Unavailable al intentar generar reportes mensuales. Esto está afectando gravemente nuestras operaciones de cierre de mes.</p>
                        <div class="text-sm text-glass-muted">
                            <i class="bi bi-calendar3"></i> Creado: 15/11/2025 09:30 AM | 
                            <i class="bi bi-globe"></i> Origen: Portal Web
                        </div>
                    </div>
                </div>

                <!-- Req 7 y 8: Timeline con Trazabilidad y Chat (CDT) -->
                <div class="card-glass mb-4">
                    <div class="card-glass-header bg-gradient-primary">
                        <h3 class="text-xl font-bold mb-0"><i class="bi bi-chat-dots"></i> Historial de Comunicación</h3>
                    </div>
                    <div class="card-glass-body">
                        <div class="timeline-modern">
                            <!-- Mensaje del Agente (Solicitud de Info) -->
                            <div class="timeline-item-modern agent">
                                <div class="text-sm text-glass-muted mb-2">
                                    <i class="bi bi-clock"></i> 15/11/2025 11:45 AM | 
                                    <strong>Técnico Juan Pérez</strong>
                                </div>
                                <div class="timeline-bubble">
                                    <div class="bg-warning bg-opacity-10 border border-warning border-opacity-50 rounded-lg p-3 mb-2">
                                        <div class="flex items-center gap-2 mb-2">
                                            <i class="bi bi-info-circle-fill text-warning"></i>
                                            <strong class="text-warning">SOLICITUD DE INFORMACIÓN</strong>
                                        </div>
                                        <p class="mb-0">Necesitamos que nos proporcione el log completo del error. También confirme si el problema persiste al usar credenciales de administrador.</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Mensaje del Cliente -->
                            <div class="timeline-item-modern client">
                                <div class="text-sm text-glass-muted mb-2">
                                    <i class="bi bi-clock"></i> 15/11/2025 10:15 AM | 
                                    <strong>Usted (Banco Central)</strong>
                                </div>
                                <div class="timeline-bubble">
                                    <p class="mb-2">Adjunto capturas del error. El problema ocurre con todos los usuarios.</p>
                                    <div class="flex gap-2">
                                        <span class="badge-modern badge-media">
                                            <i class="bi bi-paperclip"></i> error_screenshot.png
                                        </span>
                                    </div>
                                </div>
                            </div>

                            <!-- Evento del Sistema -->
                            <div class="timeline-item-modern system">
                                <div class="text-sm text-glass-muted mb-2">
                                    <i class="bi bi-clock"></i> 15/11/2025 09:45 AM | 
                                    <strong>Sistema Novatronic</strong>
                                </div>
                                <div class="timeline-bubble">
                                    <p class="mb-0 text-sm">Ticket clasificado como <strong>Incidente - Módulo Reportes</strong>. Prioridad: <strong>CRÍTICA</strong>. Asignado a: <strong>Juan Pérez</strong> (Grupo Desarrollo).</p>
                                </div>
                            </div>

                            <!-- Creación -->
                            <div class="timeline-item-modern system">
                                <div class="text-sm text-glass-muted mb-2">
                                    <i class="bi bi-clock"></i> 15/11/2025 09:30 AM | 
                                    <strong>Sistema</strong>
                                </div>
                                <div class="timeline-bubble">
                                    <p class="mb-0 text-sm"><i class="bi bi-plus-circle"></i> Ticket creado</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Req 8: Responder (Chat Integrado) -->
                <div class="card-glass">
                    <div class="card-glass-header bg-gradient-success">
                        <h3 class="text-xl font-bold mb-0"><i class="bi bi-reply-fill"></i> Responder al Técnico</h3>
                    </div>
                    <div class="card-glass-body">
                        <p class="text-glass-muted mb-3">Su respuesta será enviada al técnico asignado y se registrará en el historial del ticket.</p>
                        <textarea class="form-glass w-full mb-3" rows="4" placeholder="Escriba su respuesta o proporcione la información solicitada..."></textarea>
                        <div class="mb-3">
                            <label class="form-label-glass"><i class="bi bi-paperclip"></i> Adjuntar archivos</label>
                            <input type="file" class="form-glass w-full" multiple>
                        </div>
                        <button class="btn btn-nova btn-nova-success btn-lg w-full">
                            <i class="bi bi-send-fill"></i> Enviar Respuesta
                        </button>
                    </div>
                </div>
            </div>

            <!-- Sidebar -->
            <div class="col-lg-4">
                <!-- Metadatos del Ticket -->
                <div class="card-glass sticky-card mb-4">
                    <div class="card-glass-header bg-gradient-primary">
                        <h3 class="text-lg font-bold mb-0"><i class="bi bi-info-circle"></i> Información del Ticket</h3>
                    </div>
                    <div class="card-glass-body">
                        <div class="space-y-3">
                            <div class="p-3 rounded-lg" style="background: rgba(255,255,255,0.05);">
                                <div class="text-xs text-glass-muted mb-1">Estado</div>
                                <div class="font-semibold text-warning">
                                    <i class="bi bi-chat-left-dots-fill"></i> Pendiente de Cliente
                                </div>
                            </div>
                            <div class="p-3 rounded-lg" style="background: rgba(255,255,255,0.05);">
                                <div class="text-xs text-glass-muted mb-1">Prioridad</div>
                                <div><span class="badge-modern badge-critica">CRÍTICA</span></div>
                            </div>
                            <div class="p-3 rounded-lg" style="background: rgba(255,255,255,0.05);">
                                <div class="text-xs text-glass-muted mb-1">Técnico Asignado</div>
                                <div class="font-semibold text-white">Juan Pérez</div>
                            </div>
                            <div class="p-3 rounded-lg" style="background: rgba(255,255,255,0.05);">
                                <div class="text-xs text-glass-muted mb-1">Categoría</div>
                                <div class="font-semibold text-white">Módulo de Reportes</div>
                            </div>
                            <div class="p-3 rounded-lg" style="background: rgba(56, 239, 125, 0.1); border: 1px solid rgba(56, 239, 125, 0.3);">
                                <div class="text-xs text-glass-muted mb-1">SLA - Tiempo Límite</div>
                                <div class="font-semibold text-success">
                                    <i class="bi bi-clock-fill"></i> 1 hora (En pausa)
                                </div>
                                <small class="text-xs">El contador de SLA se pausó al solicitar su respuesta</small>
                            </div>
                        </div>

                        <hr class="border-white border-opacity-20 my-4">

                        <button class="btn btn-nova btn-nova-success w-full" data-bs-toggle="modal" data-bs-target="#resolverModal">
                            <i class="bi bi-check-circle-fill"></i> Marcar como Resuelto
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Resolver -->
    <div class="modal fade" id="resolverModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content" style="background: var(--glass-bg); backdrop-filter: blur(16px); border: 1px solid var(--glass-border); color: white;">
                <div class="modal-header border-0">
                    <h5 class="modal-title"><i class="bi bi-check-circle text-success"></i> Marcar como Resuelto</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p>¿Confirma que el problema ha sido solucionado satisfactoriamente?</p>
                    <p class="text-sm text-glass-muted">El técnico recibirá una notificación para proceder con el cierre oficial del ticket.</p>
                </div>
                <div class="modal-footer border-0">
                    <button type="button" class="btn btn-nova" style="background: rgba(255,255,255,0.1); color: white;" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-nova btn-nova-success">Confirmar Solución</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>